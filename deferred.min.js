!function(){var n,r,e,t,u,a,l,o,i,s,c,f,p,g,h=[].slice;u="2.2.0",r="pending",t="resolved",e="rejected",i=function(n,r){return null!=n?n.hasOwnProperty(r):void 0},c=function(n){return i(n,"length")&&i(n,"callee")},f=function(n){return i(n,"promise")&&"function"==typeof(null!=n?n.promise:void 0)},o=function(n){return c(n)?o(Array.prototype.slice.call(n)):Array.isArray(n)?n.reduce(function(n,r){return Array.isArray(r)?n.concat(o(r)):(n.push(r),n)},[]):[n]},a=function(n,r){return 0>=n?r():function(){return--n<1?r.apply(this,arguments):void 0}},p=function(n,r){return function(){var e;return e=[n].concat(Array.prototype.slice.call(arguments,0)),r.apply(this,e)}},l=function(n,r,e){var t,u,a,l,i;for(l=o(n),i=[],u=0,a=l.length;a>u;u++)t=l[u],i.push(t.call.apply(t,[e].concat(h.call(r))));return i},n=function(){var u,a,i,s,c;return c=r,i=[],s=[],a={},this.promise=function(u){var p,g;return u=u||{},u.state=function(){return c},g=function(n,e){return function(){return c===r&&e.push.apply(e,o(arguments)),n()&&l(arguments,a),u}},u.done=g(function(){return c===t},i),u.fail=g(function(){return c===e},s),u.always=function(){var n;return(n=u.done.apply(u,arguments)).fail.apply(n,arguments)},p=function(r,e){var t,a;return t=new n,a=function(n,r,e){return e?u[n](function(){var t,u;return t=1<=arguments.length?h.call(arguments,0):[],u=e.apply(null,t),f(u)?u[n](function(){var n;return n=1<=arguments.length?h.call(arguments,0):[],r.apply(null,n)}):r(u)}):u[n](function(){var n;return n=1<=arguments.length?h.call(arguments,0):[],r.apply(null,n)})},a("done",t.resolve,r),a("fail",t.reject,e),t},u.pipe=p,u.then=p,null==u.promise&&(u.promise=function(){return u}),u},this.promise(this),u=function(n,e,t){return function(){return c===r&&(c=n,a=arguments,l(e,a,t)),this}},this.resolve=u(t,i),this.reject=u(e,s),this.resolveWith=function(){var n,r;return r=arguments[0],n=2<=arguments.length?h.call(arguments,1):[],u(t,i,r).apply(null,n)},this.rejectWith=function(){var n,r;return r=arguments[0],n=2<=arguments.length?h.call(arguments,1):[],u(e,s,r).apply(null,n)},this},g=function(){var r,e,t,u,l,i,s;if(e=o(arguments),l=new n,!e.length)return l.resolve().promise();for(u=[],t=a(e.length,function(){return l.resolve.apply(l,u)}),e.forEach(function(n,r){return f(n)?n.done(function(){var n;return n=1<=arguments.length?h.call(arguments,0):[],u[r]=n.length>1?n:n[0],t()}):(u[r]=n,t())}),i=0,s=e.length;s>i;i++)r=e[i],f(r)&&r.fail(l.reject);return l.promise()},s=function(r){return r.Deferred=function(){return new n},r.ajax=p(r.ajax,function(r,e){var t,u,a,l;return null==e&&(e={}),u=new n,t=function(n,r){return p(n,function(){var n,e;return e=arguments[0],n=2<=arguments.length?h.call(arguments,1):[],e&&e.apply(null,n),r.apply(null,n)})},e.success=t(e.success,u.resolve),e.error=t(e.error,u.reject),l=r(e),a=u.promise(),a.abort=function(){return l.abort()},a}),r.when=g},"undefined"!=typeof exports?(exports.Deferred=function(){return new n},exports.when=g,exports.installInto=s):(this.Deferred=function(){return new n},this.Deferred.when=g,this.Deferred.installInto=s)}.call(this);